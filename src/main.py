
import asyncio
import asyncio
from sqlalchemy.ext.asyncio import create_async_engine
from data_accessor.application.music_query_controller import MusicQueryController
from data_accessor.domain.services._music_query_service import MusicQueryService
from data_accessor.infrastructure.repositories._music_query_repository import MusicQueryRepository
from data_accessor.infrastructure.database_config import DatabaseConfig

# Use DatabaseConfig to abstract credentials and connection string
db_config = DatabaseConfig()
engine = create_async_engine(db_config.connection_string)
repo = MusicQueryRepository(engine=engine)
service = MusicQueryService(repository=repo)
controller = MusicQueryController(music_query_service=service)

embeddings = '[-1.0088751316070557, -0.37333306670188904, 0.654964804649353, 0.0692020058631897, 0.035954881459474564, 0.04581812769174576, 0.4061923921108246, -0.08870425820350647, 0.1310495287179947, 0.22668766975402832, -0.08319807052612305, -0.4587930738925934, -0.26822060346603394, -0.1362505704164505, 0.3162887692451477, 0.9217908382415771, -0.03934434801340103, 0.16780145466327667, -0.5179322957992554, -0.6196506023406982, -0.3700571656227112, 0.328119695186615, -0.6743011474609375, -0.02693025767803192, 0.7287524938583374, -0.42613697052001953, 0.03784877061843872, -0.08428937196731567, -0.8280326128005981, -0.5624650716781616, -0.15084536373615265, -0.9034822583198547, 0.39502954483032227, -0.39061659574508667, 0.5238406658172607, -0.3043478727340698, 0.01272571086883545, 0.07921801507472992, 0.1292598396539688, -0.41909193992614746, 0.4124658405780792, -0.1837184578180313, -0.8492440581321716, -0.7074874043464661, 0.09652946889400482, 0.4454955458641052, -0.44917047023773193, -0.0982585921883583, 0.07455384731292725, 0.23909515142440796, 0.6150885820388794, 0.22101449966430664, 0.20239688456058502, -0.15589265525341034, 0.1526704579591751, 0.19948536157608032, -0.021253615617752075, 0.14414039254188538, 0.3437904715538025, 0.33248913288116455, -0.05082143843173981, 0.13944873213768005, -1.0668798685073853, 0.5314555168151855, 0.03613542765378952, -0.20948442816734314, 0.04793804883956909, 0.18832212686538696, 0.3457571864128113, 0.30509546399116516, -0.14788010716438293, -0.30531078577041626, 0.5096825361251831, 0.5435898303985596, 0.03291827812790871, -0.2631258964538574, 0.5080044269561768, -0.14971071481704712, -0.3338928520679474, -0.09793217480182648, 0.6151379942893982, 0.2379334568977356, -0.03695586696267128, -0.5819177031517029, -0.8215563893318176, 0.35020139813423157, -0.03703839331865311, -0.1105467826128006, 0.6073465943336487, 0.12257061898708344, -0.24256865680217743, 0.4021359384059906, 0.02094261348247528, -0.520998477935791, 0.30626726150512695, 0.26852038502693176, -0.19357404112815857, -0.07753691077232361, -0.6173719167709351, 0.4501423239707947, 0.12000064551830292, 0.636237382888794, 0.2639780342578888, 0.206856369972229, 0.048379238694906235, -0.8196424245834351, 0.35798439383506775, 0.1337406486272812, 0.22409889101982117, -0.5094864964485168, 0.1543111503124237, 0.028383426368236542, 0.9548167586326599, -0.31261080503463745, 0.9530917406082153, -0.03351506590843201, 0.46467071771621704, -0.31218868494033813, 0.003555603325366974, -0.02390100620687008, -0.31055569648742676, 0.5322386026382446, 0.3484792113304138, 0.29867586493492126, -0.11558756232261658, -0.004878431558609009, 0.05328275263309479, 0.25799036026000977, 0.1976775825023651, -0.35643142461776733, 1.0544257164001465, 0.4379884600639343, -0.4601908028125763, -0.3508841395378113, -0.5933845639228821, -0.1318455934524536, -0.4163989722728729, 0.1636362075805664, -0.3045527935028076, 0.17152273654937744, 0.054894715547561646, -0.38845792412757874, -0.2834237515926361, -0.42302387952804565, 0.14585067331790924, -0.2948392927646637, -0.7470855712890625, 0.8431240320205688, -0.3494991660118103, 0.9671363830566406, -0.1929476410150528, -0.272418737411499, -0.41861492395401, 0.395264595746994, 0.23794761300086975, 0.31689947843551636, 0.7603846192359924, 0.31269216537475586, -0.43720024824142456, 0.24873599410057068, 0.7340465784072876, -0.36998340487480164, -0.5325832962989807, 0.03405687212944031, -0.2438332736492157, -1.3547492027282715, -0.09387928247451782, -0.12513642013072968, 0.21775352954864502, -0.020584706217050552, -0.5643269419670105, -0.09048636257648468, -0.6129195690155029, -0.6065974235534668, 0.2966699004173279, -0.6784401535987854, 0.4291806221008301, -0.5406925082206726, 0.15430277585983276, -0.44464752078056335, -0.3240031599998474, -0.14577043056488037, -0.11337228119373322, 0.10379444807767868, 0.3666101396083832, -0.04778780788183212, 0.25368520617485046, -0.28103137016296387, 0.4010397791862488, 0.7130207419395447, -0.04235704243183136, -0.14827416837215424, -0.33197909593582153, -0.23994781076908112, -0.016537737101316452, -0.31998899579048157, -0.41627925634384155, 0.20575955510139465, -0.24889200925827026, -0.3555987775325775, 0.595579981803894, -0.08357203006744385, 0.2771272659301758, -0.13721534609794617, -0.0012220367789268494, 0.4312097132205963, -0.5099626183509827, 0.15067638456821442, -0.35786235332489014, 0.1741161048412323, 0.20436614751815796, -0.165376678109169, -0.3275124132633209, 0.20529469847679138, -0.03297227621078491, -0.20657682418823242, 0.13951128721237183, 0.45538756251335144, -0.2921263873577118, 0.24164535105228424, -0.4481338858604431, -0.31918662786483765, -0.2751626968383789, -1.5687183141708374, 1.3458067178726196, 0.13798578083515167, -0.06749150156974792, 0.15928485989570618, -0.0779050812125206, 0.6353064179420471, -0.19290204346179962, 0.7909596562385559, 1.6358798742294312, 0.6962260007858276, 1.0038899183273315, -0.1914362907409668, 0.6899589896202087, -0.5857856869697571, 0.483137845993042, -0.14644187688827515, -0.007873114198446274, 0.25349706411361694, 0.6580443382263184, -0.050150346010923386, -0.43290236592292786, -0.7065499424934387, -0.678246796131134, 0.2815926969051361, -0.42885321378707886, 1.5165305137634277, 1.524175763130188, -0.3412266671657562, 0.015517659485340118, -0.0754397064447403, 0.579332709312439, -0.31390196084976196, -1.4991686344146729, 0.42606496810913086, 0.0029971152544021606, 0.6698721051216125, -0.4441486597061157, -0.7565924525260925, -0.6338880062103271, -0.2143404185771942, 0.5927827954292297, 0.14874015748500824, -1.0090601444244385, 0.008489266037940979, -0.12513843178749084, -0.18236008286476135, -0.3433346748352051, 0.6134859323501587, -0.3123728632926941, 0.42712536454200745, 0.11658912897109985, -0.03462183475494385, -0.5503124594688416, 0.10129708796739578, 0.006923414766788483, -0.35721272230148315, 0.7923104763031006, 0.31346213817596436, -0.6449599266052246, -0.07126761972904205, 0.04835379123687744, 0.26997271180152893, 0.43752843141555786, 0.010679461061954498, -0.3990499675273895, 0.11263781785964966, -0.19924061000347137, -0.31665459275245667, -0.6373299956321716, -0.042972978204488754, 0.3667020797729492, -0.12798553705215454, 0.3021754324436188, 0.1165836900472641, -0.26455530524253845, -0.037238314747810364, -0.6238417625427246, 0.3569347858428955, -0.008007101714611053, -0.05141659080982208, -0.1515110731124878, 0.07742591202259064, -0.19394001364707947, -0.2201472818851471, 0.039986997842788696, 0.9137195348739624, -0.04269445687532425, 0.4055884778499603, -0.366254985332489, -0.1138417050242424, 0.013236124068498611, -0.7584112286567688, -0.32698962092399597, 0.3664434254169464, 0.21485979855060577, -1.6872234344482422, -0.33362850546836853, -0.07528524100780487, 0.5835369229316711, -0.3955939710140228, 0.5815169215202332, 0.8978261947631836, -0.22483685612678528, 0.06256476044654846, -0.045901767909526825, -0.23134464025497437, -0.0460817813873291, -0.04278906434774399, 0.5883804559707642, 0.5357578992843628, 0.2305065095424652, 0.767174243927002, -0.10873225331306458, 0.6847750544548035, 0.6338344812393188, -0.054250121116638184, 0.8793668746948242, 1.8090193271636963, -0.30668318271636963, -0.011097967624664307, 0.09481826424598694, -0.5040595531463623, 0.15199029445648193, -0.05553784966468811, -0.6232953071594238, -0.24372410774230957, 0.48815828561782837, 0.670738935470581, -0.3269302248954773, -0.1907263994216919, 0.8630274534225464, 0.11878499388694763, 0.8432804346084595, -0.23985329270362854, -0.2561209201812744, -0.20604999363422394, -0.20552968978881836, -0.03361031040549278, 0.11508253216743469, 0.5557085871696472, -0.977239727973938, -0.44500184059143066, 0.3787946403026581, -0.8472467064857483, -0.11761941015720367, -0.00016727298498153687, -0.262254536151886, 0.04988788813352585, -0.002112012356519699, 0.17206791043281555, 0.4640192687511444, -0.42548078298568726, -0.29154765605926514, 0.08797653019428253, -0.38868802785873413, 0.3373687267303467, -0.558129072189331, -0.49612677097320557, -0.26180073618888855, 0.476557195186615]'

async def main():
    result = await controller.fetch_database_schema(embeddings)
    print(result)

asyncio.run(main())
